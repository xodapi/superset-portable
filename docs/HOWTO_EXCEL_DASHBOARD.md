# Инструкция: Как создать дашборд из Excel файлов

Эта инструкция поможет вам загрузить данные из Excel/CSV в Superset и создать свой собственный дашборд.

## Шаг 1: Подготовка данных

Superset лучше всего работает с плоскими таблицами. Убедитесь, что ваш Excel файл:
1.  **Имеет одну строку заголовков** (первая строка).
2.  **Не содержит объединенных ячеек** (merged cells).
3.  **Не содержит пустых строк** перед заголовком.
4.  **Даты** в едином формате (например, `YYYY-MM-DD` или `DD.MM.YYYY`).

**Пример хорошей таблицы:**
| Дата | Регион | Выручка |
|---|---|---|
| 2024-01-01 | Москва | 1000 |
| 2024-01-02 | СПб | 1500 |

Сохраните файл как **CSV (разделители - запятые)** или **Excel (.xlsx)**.
*Рекомендуется CSV для больших файлов.*

---

## Шаг 2: Загрузка данных в Superset

1.  Откройте Superset: [http://localhost:8088](http://localhost:8088)
2.  В верхнем меню выберите **"+" (Плюс) -> Data -> Upload CSV to database**.
    *   *(Если у вас Excel, выберите Upload Excel)*.
3.  Заполните форму:
    *   **Table Name**: Название таблицы латиницей (например, `sales_2024`).
    *   **CSV File**: Выберите ваш файл.
    *   **Database**: Выберите `examples` (или `superset` если examples недоступна).
    *   **Before the CSV contains a header**: Оставьте пустым, если заголовки в 1-й строке.
4.  Нажмите **Save**.

---

## Шаг 3: Создание Графиков (Charts)

1.  Перейдите в меню **Charts -> + Chart**.
2.  **Choose a Dataset**: Выберите таблицу, которую вы только что загрузили (`sales_2024`).
3.  **Choose a Chart Type**: Выберите тип графика (например, *Pie Chart* или *Big Number*).
4.  Нажмите **Create New Chart**.

### Настройка графика:
Слева находится панель настроек.
*   **Metrics**: Что считаем? (Например, `SUM(Выручка)`).
*   **Group by**: По какой категории делим? (Например, `Регион`).
*   **Time Range**: За какой период? (Выберите `No filter`, если хотите все данные).

Нажмите **Run**, чтобы увидеть результат.
Когда готово, нажмите **Save**.
*   Дайте графику имя.
*   Выберите **Add to Dashboard** -> **Save as new dashboard** (для первого графика) или выберите существующий.

---

## Шаг 4: Сборка Дашборда

1.  Перейдите в меню **Dashboards** и откройте ваш дашборд.
2.  Нажмите **Edit dashboard** (карандаш справа нужен для редактирования).
3.  **Добавление элементов**:
    *   Справа в панели **Components** вы можете перетаскивать *Row*, *Column*, *Header*, *Markdown* (текст).
    *   В панели **Charts** выберите ваши сохраненные графики и перетащите их на экран.
4.  **Разметка**:
    *   Растягивайте графики за нижний правый угол.
    *   Меняйте местами, перетаскивая их.
5.  Нажмите **Save** в верхней части экрана.

---

## Советы
*   **Фильтры**: Чтобы добавить фильтры (например, по дате или региону), используйте **Dashboard Native Filters** (меню слева в режиме редактирования дашборда -> Filters -> + Add Filter).
*   **Цвета**: Цветовую схему можно поменять в свойствах дашборда (три точки -> Edit properties -> Color Scheme).

## Что делать, если "Ошибка соединения"?
В портативной версии база данных может "теряться" при переносе папки.
Просто перезапустите `start_superset.bat` — он автоматически починит пути.
