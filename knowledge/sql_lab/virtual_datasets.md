---
title: –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã
status: public
created: 2026-01-28
tags: [sql, –¥–∞—Ç–∞—Å–µ—Ç—ã, –∑–∞–ø—Ä–æ—Å—ã]
---

# –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã üìä

–î–∞—Ç–∞—Å–µ—Ç—ã, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ SQL-–∑–∞–ø—Ä–æ—Å–∞—Ö –≤–º–µ—Å—Ç–æ —Ç–∞–±–ª–∏—Ü.

---

## –ß—Ç–æ —ç—Ç–æ

**–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç** = SQL-–∑–∞–ø—Ä–æ—Å, —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π –∫–∞–∫ –¥–∞—Ç–∞—Å–µ—Ç.

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –§–∏–∑–∏—á–µ—Å–∫–∏–π –¥–∞—Ç–∞—Å–µ—Ç                 ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ –¢–∞–±–ª–∏—Ü–∞ "orders"               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç                ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ SELECT ... FROM orders         ‚îÇ
‚îÇ         JOIN customers ...          ‚îÇ
‚îÇ         WHERE status = 'active'     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### ‚úÖ –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è

- JOIN –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü
- –°–ª–æ–∂–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- –ê–≥—Ä–µ–≥–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ SQL

### ‚ùå –ù–µ –Ω—É–∂–µ–Ω –µ—Å–ª–∏

- –ü—Ä–æ—Å—Ç–∞—è —Ç–∞–±–ª–∏—Ü–∞ –±–µ–∑ –¥–∂–æ–π–Ω–æ–≤
- –í—Å–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤ –º–µ—Ç—Ä–∏–∫–∞—Ö Superset

---

## –°–æ–∑–¥–∞–Ω–∏–µ

### –°–ø–æ—Å–æ–± 1: –ò–∑ SQL Lab

1. –ù–∞–ø–∏—à–∏—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –≤ SQL Lab
2. **Save ‚Üí Save Dataset**
3. –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
4. –î–∞—Ç–∞—Å–µ—Ç –ø–æ—è–≤–∏—Ç—Å—è –≤ **Data ‚Üí Datasets**

### –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

1. **Data ‚Üí Datasets ‚Üí "+ Dataset"**
2. –¢–∏–ø: **Virtual**
3. –í–≤–µ–¥–∏—Ç–µ SQL-–∑–∞–ø—Ä–æ—Å

---

## –ü—Ä–∏–º–µ—Ä—ã

### JOIN —Ç–∞–±–ª–∏—Ü

```sql
SELECT 
    o.order_id,
    o.order_date,
    o.amount,
    c.customer_name,
    c.region,
    p.product_name,
    p.category
FROM orders o
JOIN customers c ON o.customer_id = c.id
JOIN products p ON o.product_id = p.id
```

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è

```sql
SELECT 
    date_trunc('day', created_at) as date,
    region,
    COUNT(*) as orders_count,
    SUM(amount) as total_amount,
    AVG(amount) as avg_amount
FROM orders
GROUP BY 1, 2
```

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è

```sql
SELECT *
FROM orders
WHERE status = 'completed'
  AND amount > 0
  AND order_date >= '2025-01-01'
```

### –í—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å—Ç–æ–ª–±—Ü—ã

```sql
SELECT 
    *,
    amount * quantity as total,
    CASE 
        WHEN amount > 10000 THEN 'Large'
        WHEN amount > 1000 THEN 'Medium'
        ELSE 'Small'
    END as order_size,
    EXTRACT(YEAR FROM order_date) as year,
    EXTRACT(MONTH FROM order_date) as month
FROM orders
```

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞

### –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å—Ç–æ–ª–±—Ü–æ–≤

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —Å—Ç–æ–ª–±—Ü—ã:

1. **Data ‚Üí Datasets ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç–∞—Å–µ—Ç**
2. **Columns** tab

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| **Type** | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö (string, int, datetime) |
| **Temporal** | –≠—Ç–æ —Å—Ç–æ–ª–±–µ—Ü –≤—Ä–µ–º–µ–Ω–∏? |
| **Filterable** | –ú–æ–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å? |
| **Groupable** | –ú–æ–∂–Ω–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å? |

### –ú–µ—Ç—Ä–∏–∫–∏

–î–æ–±–∞–≤—å—Ç–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏:

1. **Metrics** tab
2. **"+ Metric"**

```sql
-- –°—É–º–º–∞ –ø—Ä–æ–¥–∞–∂
SUM(amount)

-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
COUNT(DISTINCT customer_id)

-- –°—Ä–µ–¥–Ω–∏–π —á–µ–∫
SUM(amount) / NULLIF(COUNT(*), 0)
```

---

## –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ

### –î–ª—è –¥–æ—Ä–æ–≥–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç SQL –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ. –í–∫–ª—é—á–∏—Ç–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ:

1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞
2. **Cache Timeout** ‚Üí –≤—Ä–µ–º—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö

### –ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è

–î–ª—è –æ—á–µ–Ω—å —Ç—è–∂—ë–ª—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —Å–æ–∑–¥–∞–π—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤ –ë–î:

```sql
CREATE MATERIALIZED VIEW mv_daily_stats AS
SELECT 
    date_trunc('day', created_at) as date,
    COUNT(*) as orders,
    SUM(amount) as revenue
FROM orders
GROUP BY 1;
```

–ó–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–∞–∫ –¥–∞—Ç–∞—Å–µ—Ç.

---

## Jinja –≤ –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö

### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –¥–∞—Ç–∞—Å–µ—Ç—ã

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Jinja-—à–∞–±–ª–æ–Ω—ã:

```sql
SELECT *
FROM orders
WHERE owner = '{{ current_username() }}'
  {% if filter_values('region') %}
  AND region IN {{ filter_values('region') | where_in }}
  {% endif %}
```

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: [[Jinja-—à–∞–±–ª–æ–Ω—ã]]

---

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

- –î–æ–±–∞–≤–ª—è–π—Ç–µ `WHERE` –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–Ω–¥–µ–∫—Å—ã –≤ –∏—Å—Ö–æ–¥–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö
- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ JOIN
- –î–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–π ‚Äî –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è

### ‚ùå –ò–∑–±–µ–≥–∞–π—Ç–µ

- `SELECT *` ‚Äî —É–∫–∞–∑—ã–≤–∞–π—Ç–µ —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã
- JOIN –±–µ–∑ —É—Å–ª–æ–≤–∏–π
- –í–ª–æ–∂–µ–Ω–Ω—ã—Ö –ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–≤ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

---

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞

### –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. **Data ‚Üí Datasets ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç–∞—Å–µ—Ç**
2. **SQL** tab
3. –ò–∑–º–µ–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å
4. **Save**

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤

–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è SQL:

1. **Columns** tab
2. **"Sync columns from source"**

---

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ vs –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

| | |
|---|---|
| ‚úÖ | –°–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –Ω–∞ SQL |
| ‚úÖ | JOIN –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü |
| ‚úÖ | –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è |
| ‚úÖ | –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö |

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

| | |
|---|---|
| ‚ùå | –ó–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑ |
| ‚ùå | –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ö–µ–º—ã |
| ‚ùå | –°–ª–æ–∂–Ω–µ–µ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å |

---

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### "Column not found"

–°—Ç–æ–ª–±–µ—Ü –∏—Å—á–µ–∑ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞. –û–±–Ω–æ–≤–∏—Ç–µ:
1. **Columns ‚Üí Sync from source**

### –ú–µ–¥–ª–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å

1. –î–æ–±–∞–≤—å—Ç–µ –∏–Ω–¥–µ–∫—Å—ã –≤ –ë–î
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ EXPLAIN ANALYZE
3. –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é

### –û—à–∏–±–∫–∞ Jinja

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —à–∞–±–ª–æ–Ω–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SQL Lab –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏.

---

## –°–º. —Ç–∞–∫–∂–µ

- [[SQL Lab]] ‚Äî —Ä–µ–¥–∞–∫—Ç–æ—Ä SQL
- [[Jinja-—à–∞–±–ª–æ–Ω—ã]] ‚Äî –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- [[–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö]] ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö
